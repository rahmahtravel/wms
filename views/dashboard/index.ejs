<%- include('../partials/head') %>

<style>
  /* Gradient Header Styles */
  :root {
    --primary-color: #f9a825;
    --primary-light: #ffd54f;
    --primary-dark: #f57f17;
  }

  .gradient-header {
    background: linear-gradient(
      135deg,
      var(--primary-color) 0%,
      var(--primary-light) 100%
    );
    position: relative;
    overflow: hidden;
  }

  .gradient-header::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23ffffff' fill-opacity='0.1' fill-rule='evenodd'/%3E%3C/svg%3E");
    opacity: 0.6;
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slideInRight {
    from {
      opacity: 0;
      transform: translateX(-20px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes pulse-soft {
    0%, 100% {
      opacity: 1;
    }
    50% {
      opacity: 0.8;
    }
  }

  .animate-fadeInUp {
    animation: fadeInUp 0.6s ease-out forwards;
  }

  .animate-slideInRight {
    animation: slideInRight 0.6s ease-out forwards;
  }

  .stat-card {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    animation: fadeInUp 0.6s ease-out forwards;
  }

  .stat-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  }

  .gradient-bg-blue {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  }

  .gradient-bg-green {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
  }

  .gradient-bg-purple {
    background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
  }

  .gradient-bg-orange {
    background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
  }

  .glass-effect {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
  }

  .activity-item {
    transition: all 0.3s ease;
  }

  .activity-item:hover {
    transform: translateX(5px);
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  }

  .scroll-smooth {
    scroll-behavior: smooth;
  }

  /* Gradient Text */
  .gradient-text {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  /* Custom Scrollbar */
  .custom-scrollbar::-webkit-scrollbar {
    width: 6px;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 10px;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    background: linear-gradient(135deg, var(--primary-color, #f9a825) 0%, var(--primary-light, #ffd54f) 100%);
    border-radius: 10px;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: var(--primary-dark, #f57f17);
  }

  /* Stagger animation delays */
  .stat-card:nth-child(1) { animation-delay: 0s; }
  .stat-card:nth-child(2) { animation-delay: 0.1s; }
  .stat-card:nth-child(3) { animation-delay: 0.2s; }
  .stat-card:nth-child(4) { animation-delay: 0.3s; }

  /* Statistics Cards Collapse Styles */
  .stats-collapsed {
    max-height: 0;
    opacity: 0;
    margin-bottom: 0 !important;
    padding-top: 0 !important;
    padding-bottom: 0 !important;
  }
  
  .stats-expanded {
    max-height: 500px;
    opacity: 1;
  }

  /* Equipment Cards Collapse Styles */
  .equipment-collapsed {
    max-height: 0;
    opacity: 0;
    padding-top: 0 !important;
    padding-bottom: 0 !important;
  }
  
  .equipment-expanded {
    max-height: 2000px;
    opacity: 1;
  }

  /* Development Alert Animations */
  @keyframes alertSlideIn {
    from {
      opacity: 0;
      transform: translateY(-100%);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes alertSlideOut {
    from {
      opacity: 1;
      transform: translateY(0);
    }
    to {
      opacity: 0;
      transform: translateY(-100%);
    }
  }

  @keyframes modalFadeIn {
    from {
      opacity: 0;
      transform: scale(0.9);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  /* Enhanced Alert Styles */
  #developmentAlert {
    animation: alertSlideIn 0.8s ease-out forwards;
    transition: all 0.3s ease-in-out;
  }

  #developmentModal.hidden {
    display: none !important;
  }

  #developmentModal:not(.hidden) .bg-white {
    animation: modalFadeIn 0.3s ease-out forwards;
  }

  /* Improved Button Hover Effects */
  .development-btn {
    position: relative;
    overflow: hidden;
  }

  .development-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
    transition: left 0.5s;
  }

  .development-btn:hover::before {
    left: 100%;
  }

  /* Progress Bar Animation */
  @keyframes progressFill {
    from {
      width: 0%;
    }
    to {
      width: var(--progress-width, 75%);
    }
  }

  .progress-animate {
    animation: progressFill 2s ease-out forwards;
  }

  /* Responsive Design Improvements */
  @media (max-width: 768px) {
    /* Development Alert Mobile Responsive */
    #developmentAlert {
      margin-bottom: 1rem;
    }
    
    #developmentAlert .relative.z-10.p-6 {
      padding: 1rem;
    }
    
    #developmentAlert .flex.items-start.gap-4 {
      flex-direction: column;
      gap: 1rem;
      align-items: stretch;
    }
    
    #developmentAlert .flex-none.relative {
      align-self: center;
    }
    
    #developmentAlert .flex-none.relative .w-14.h-14 {
      width: 3rem;
      height: 3rem;
    }
    
    #developmentAlert .flex-none.relative .text-2xl {
      font-size: 1.25rem;
    }
    
    #developmentAlert .flex-1.text-white {
      text-align: center;
    }
    
    #developmentAlert .text-lg.font-bold {
      font-size: 1rem;
    }
    
    #developmentAlert .text-sm.leading-relaxed {
      font-size: 0.875rem;
      line-height: 1.5;
      margin-bottom: 1rem;
    }
    
    #developmentAlert .flex.flex-wrap.gap-2 {
      justify-content: center;
      gap: 0.5rem;
    }
    
    #developmentAlert .px-3.py-1 {
      padding: 0.375rem 0.75rem;
      font-size: 0.75rem;
    }
    
    .development-btn {
      font-size: 0.75rem;
      padding: 0.75rem 1rem;
      width: 100%;
      justify-content: center;
      max-width: 200px;
      margin: 0 auto;
    }
    
    /* Floating elements adjustment for mobile */
    #developmentAlert .absolute.top-2.right-2 {
      width: 2rem;
      height: 2rem;
      top: 0.5rem;
      right: 0.5rem;
    }
    
    #developmentAlert .absolute.bottom-2.left-4 {
      width: 1.5rem;
      height: 1.5rem;
      bottom: 0.5rem;
      left: 1rem;
    }
    
    #toastNotification {
      right: 1rem;
      left: 1rem;
      max-width: none;
      transform: translateY(-100%);
      top: 1rem;
    }
    
    #toastNotification.translate-x-0 {
      transform: translateY(0);
    }
    
    #toastNotification.translate-x-full {
      transform: translateY(-100%);
    }
  }

  /* Enhanced Visual Effects */
  .development-alert-glow {
    box-shadow: 
      0 0 20px rgba(245, 158, 11, 0.5),
      0 0 40px rgba(245, 158, 11, 0.3),
      0 0 60px rgba(245, 158, 11, 0.1);
  }

  /* Smooth Transitions for All Interactive Elements */
  * {
    transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;
    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
    transition-duration: 150ms;
  }

  /* Date badge - calendar style to match app theme */
  .date-badge {
    position: relative;
    background: #ffffff;
    color: #1f2937;
    border-radius: 10px;
    padding: 0.35rem 0.7rem 0.5rem;
    width: 92px; /* sedikit lebih lebar */
    box-shadow: 0 8px 20px rgba(15, 23, 42, 0.10);
    border: 1px solid rgba(31,41,55,0.07);
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
  }

  .date-head {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 22px; /* lebih pendek */
    background: linear-gradient(90deg, var(--primary-color, #f9a825), var(--primary-dark, #f57f17));
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    border-top-left-radius: 10px;
    border-top-right-radius: 10px;
    z-index: 2;
  }

  .date-head .ring {
    width: 7px;
    height: 7px;
    background: #ffffff;
    border-radius: 50%;
    box-shadow: 0 2px 6px rgba(0,0,0,0.12);
  }

  .date-body {
    position: relative;
    padding-top: 22px; /* leave space for top bar so content sits below it */
    text-align: center;
    z-index: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .date-badge .day {
    font-size: 1.35rem;
    line-height: 1;
    font-weight: 800;
    margin-top: 0; /* ensure number stays within white body */
    color: #0b1220;
  }

  .date-badge .month {
    font-size: 0.78rem;
    opacity: 0.95;
    text-transform: capitalize;
    margin-top: 2px;
    color: #334155;
  }

  .date-badge .today {
    font-size: 0.65rem;
    color: rgba(31,41,55,0.65);
    margin-top: 6px;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  @media (max-width: 1024px) {
    .date-badge { width: 84px; padding: 0.4rem 0.55rem; }
    .date-badge .day { font-size: 1.15rem; }
    .date-head { height: 20px; }
  }
</style>
  
<%- include('../partials/navbar') %>
  
<%- include('../partials/sidebar') %>
  
<!-- Main Content -->
<main id="mainContent" class="ml-64 mt-14 md:mt-20 p-4 md:p-6 transition-all duration-300 min-h-screen bg-gray-100 overflow-y-auto custom-scrollbar">
  
  <!-- Success Message removed as requested -->

  <!-- Toast Notification (Hidden by default) -->
  <!-- <div id="toastNotification" class="fixed top-4 right-4 z-[60] transform translate-x-full transition-all duration-300 max-w-sm">
    <div class="bg-white rounded-xl shadow-2xl border border-gray-200 overflow-hidden">
      <div class="p-4">
        <div class="flex items-start gap-3">
          <div class="flex-none w-8 h-8 rounded-lg flex items-center justify-center" id="toastIcon">
            <i class="fas fa-check text-white"></i>
          </div>
          <div class="flex-1">
            <h4 class="font-semibold text-gray-900 text-sm" id="toastTitle">Notification</h4>
            <p class="text-gray-600 text-xs mt-1" id="toastMessage">This is a notification message</p>
          </div>
          <button onclick="hideToast()" class="flex-none text-gray-400 hover:text-gray-600">
            <i class="fas fa-times text-sm"></i>
          </button>
        </div>
      </div>
      <div class="h-1 bg-gray-100">
        <div class="h-full bg-blue-500 transition-all duration-[3000ms] ease-linear" id="toastProgress"></div>
      </div>
    </div>
  </div> -->

  <!-- Development Details Modal (Hidden by default) -->
  <div id="developmentModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
    <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden">
      <!-- Modal Header -->
      <div class="bg-gradient-to-r from-blue-600 to-purple-600 p-6 text-white">
        <div class="flex items-center justify-between">
          <div>
            <h3 class="text-xl font-bold mb-1">Status Pengembangan Sistem</h3>
            <p class="text-blue-100 text-sm">Informasi detail fitur dan progress pengembangan</p>
          </div>
          <button onclick="closeDevelopmentModal()" class="w-8 h-8 bg-white/20 hover:bg-white/30 rounded-lg flex items-center justify-center transition-all">
            <i class="fas fa-times text-white"></i>
          </button>
        </div>
      </div>
      
      <!-- Modal Content -->
      <div class="p-6 overflow-y-auto max-h-96">
        <div class="space-y-4">
          <!-- Feature Categories -->
          <div class="grid md:grid-cols-2 gap-4">
            <div class="bg-green-50 p-4 rounded-xl border border-green-200">
              <div class="flex items-center gap-2 mb-2">
                <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                <h4 class="font-semibold text-green-800">Fitur Stabil</h4>
              </div>
              <ul class="text-sm text-green-700 space-y-1">
                <li>• Dashboard & Statistik</li>
                <li>• Manajemen Barang</li>
                <li>• Sistem Autentikasi</li>
                <li>• Database Core</li>
              </ul>
            </div>
            
            <div class="bg-yellow-50 p-4 rounded-xl border border-yellow-200">
              <div class="flex items-center gap-2 mb-2">
                <div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
                <h4 class="font-semibold text-yellow-800">Dalam Pengembangan</h4>
              </div>
              <ul class="text-sm text-yellow-700 space-y-1">
                <li>• Advanced Reporting</li>
                <li>• Notifikasi WhatsApp</li>
                <li>• Export/Import Data</li>
                <li>• Mobile Optimization</li>
              </ul>
            </div>
          </div>

          <!-- Progress Timeline -->
          <div class="bg-gray-50 p-4 rounded-xl">
            <h4 class="font-semibold text-gray-800 mb-3">Timeline Pengembangan</h4>
            <div class="space-y-3">
              <div class="flex items-center gap-3">
                <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                <span class="text-sm text-gray-600">Core System - <strong>Selesai</strong></span>
              </div>
              <div class="flex items-center gap-3">
                <div class="w-2 h-2 bg-blue-500 rounded-full animate-pulse"></div>
                <span class="text-sm text-gray-600">UI/UX Enhancement - <strong>Progress 75%</strong></span>
              </div>
              <div class="flex items-center gap-3">
                <div class="w-2 h-2 bg-yellow-500 rounded-full"></div>
                <span class="text-sm text-gray-600">Advanced Features - <strong>Progress 40%</strong></span>
              </div>
              <div class="flex items-center gap-3">
                <div class="w-2 h-2 bg-gray-400 rounded-full"></div>
                <span class="text-sm text-gray-600">Mobile App - <strong>Planning</strong></span>
              </div>
            </div>
          </div>

          <!-- Contact Info -->
          <div class="bg-blue-50 p-4 rounded-xl border border-blue-200">
            <h4 class="font-semibold text-blue-800 mb-2">Hubungi Developer</h4>
            <p class="text-sm text-blue-700 mb-2">Jika menemukan bug atau memiliki saran, silakan hubungi tim development.</p>
            <div class="flex gap-2">
              <button onclick="contactEmail()" class="px-3 py-1 bg-blue-500 text-white text-xs rounded-lg hover:bg-blue-600 transition-colors hover:scale-105">
                <i class="fas fa-envelope mr-1"></i> Email
              </button>
              <button onclick="contactWhatsApp()" class="px-3 py-1 bg-green-500 text-white text-xs rounded-lg hover:bg-green-600 transition-colors hover:scale-105">
                <i class="fab fa-whatsapp mr-1"></i> WhatsApp
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Page Header - Ultra Modern Design -->
  <div class="mb-6 animate-fadeInUp">
    <div class="rounded-2xl overflow-hidden shadow-2xl">
      <div class="gradient-header text-white p-8 md:p-10">
        <!-- Floating Circles Decoration -->
        <div class="absolute top-0 right-0 w-64 h-64 bg-white opacity-5 rounded-full -mr-32 -mt-32 animate-pulse-soft"></div>
        <div class="absolute bottom-0 left-0 w-48 h-48 bg-white opacity-5 rounded-full -ml-24 -mb-24 animate-pulse-soft" style="animation-delay: 1s;"></div>
        
        <div class="relative z-10">
          <div class="flex flex-col md:flex-row items-center gap-6">
            <!-- Modern Logo Container -->
            <div class="flex-none">
              <div class="relative group">
                <div class="absolute inset-0 bg-white opacity-20 rounded-2xl blur-xl group-hover:opacity-30 transition-opacity"></div>
                <div class="relative w-24 h-24 md:w-28 md:h-28 rounded-2xl bg-white/95 backdrop-blur-sm flex items-center justify-center shadow-2xl transform group-hover:scale-105 transition-transform duration-300">
                  <img src="/images/logo.png" alt="Logo" class="max-h-16 md:max-h-20 max-w-full object-contain">
                </div>
              </div>
            </div>
            
            <!-- Text Content -->
            <div class="flex-1 text-center md:text-left">
              <div class="inline-block px-4 py-1 bg-white/20 backdrop-blur-sm rounded-full text-xs font-semibold mb-3">
                <i class="fas fa-sparkles mr-1"></i> Dashboard Overview
              </div>
              <% 
                // determine display name from available locals (falls back to title)
                const displayName = (typeof user !== 'undefined' && (user.name || user.username || user.fullname))
                  || (typeof account !== 'undefined' && (account.name || account.username || account.fullname))
                  || (typeof nama !== 'undefined' && nama)
                  || (typeof username !== 'undefined' && username)
                  || title;
              %>
              <h1 class="text-2xl md:text-3xl lg:text-4xl font-black leading-tight text-white mb-2 tracking-tight">
                Selamat Datang , <%= displayName %>
              </h1>
              <p class="text-base md:text-lg text-white/90 font-medium max-w-2xl">
                <i class="fas fa-chart-line mr-2"></i>Monitoring sistem Purchasing & Logistics Rahmah Travel secara real-time
              </p>

              <% 
                // last login display: accept multiple possible property names
                const lastLoginRaw = (typeof user !== 'undefined' && (user.lastLogin || user.last_login || user.lastlogin || user.last_logged_in)) || null;
                if (lastLoginRaw) {
                  const lastDate = new Date(lastLoginRaw);
                  const todayStr = new Date().toLocaleDateString('id-ID');
                  const lastDateStr = lastDate.toLocaleDateString('id-ID');
                  const isToday = (todayStr === lastDateStr);
                  const timeStr = lastDate.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' });
              %>
                <div class="mt-3">
                  <span class="inline-block px-3 py-1 bg-white/20 backdrop-blur-sm rounded-full text-xs font-semibold">
                    <i class="far fa-clock mr-2"></i>
                    Login terakhir: <%= isToday ? ('Hari ini pukul ' + timeStr) : (lastDate.toLocaleDateString('id-ID', { day: 'numeric', month: 'short', year: 'numeric' }) + ', pukul ' + timeStr) %>
                  </span>
                </div>
              <% } %>
            </div>

            <!-- Quick Stats Badge -->
            <div class="flex-none hidden lg:block">
              <div class="date-badge" role="group" aria-label="Tanggal hari ini">
                <div class="date-head" aria-hidden="true">
                  <span class="ring"></span>
                  <span class="ring"></span>
                </div>
                <div class="date-body">
                  <div class="day" aria-hidden="true"><%= new Date().toLocaleDateString('id-ID', { day: 'numeric' }) %></div>
                  <div class="month" aria-hidden="true"><%= new Date().toLocaleDateString('id-ID', { month: 'short', year: 'numeric' }) %></div>
                  <div class="today" aria-hidden="false"><i class="far fa-calendar mr-1"></i>Today</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Development Warning Alert - Modern & Elegant Design -->
  <div class="mb-6 animate-fadeInUp" id="developmentAlert">
    <div class="relative overflow-hidden rounded-2xl shadow-xl development-alert-glow">
      <!-- Gradient Background -->
      <div class="absolute inset-0 bg-gradient-to-r from-amber-500 via-orange-500 to-red-500 opacity-90"></div>
      
      <!-- Animated Background Pattern -->
      <div class="absolute inset-0 opacity-10">
        <div class="absolute top-0 left-0 w-full h-full bg-[url('data:image/svg+xml,%3Csvg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%23ffffff" fill-opacity="0.4"%3E%3Ccircle cx="7" cy="7" r="7"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')] animate-pulse"></div>
      </div>

      <!-- Floating Elements -->
      <div class="absolute top-2 right-2 w-16 h-16 bg-white/10 rounded-full animate-pulse" style="animation-delay: 0.5s;"></div>
      <div class="absolute bottom-2 left-4 w-8 h-8 bg-white/15 rounded-full animate-pulse" style="animation-delay: 1s;"></div>
      
      <!-- Main Content -->
      <div class="relative z-10 p-6">
        <div class="flex items-start gap-4">
          <!-- Animated Logo Container -->
          <div class="flex-none relative">
            <div class="absolute inset-0 bg-white/20 rounded-xl blur-sm"></div>
            <div class="relative w-14 h-14 bg-white/25 backdrop-blur-sm rounded-xl flex items-center justify-center border border-white/30 anima">
              <i class="fas fa-code text-2xl text-white"></i>
            </div>
          </div>
          
          <!-- Alert Content -->
          <div class="flex-1 text-white">
            <div class="flex items-start justify-between">
              <div class="flex-1">
                <div class="flex items-center gap-2 mb-2">
                  <h3 class="text-lg font-bold text-white">Dalam Pengembangan</h3>
                  <div class="px-3 py-1 bg-white/20 backdrop-blur-sm rounded-full text-xs font-semibold border border-white/30">
                    <i class="fas fa-code mr-1"></i>Beta Version
                  </div>
                </div>
                <p class="text-white/90 text-sm leading-relaxed mb-3">
                  Sistem <strong>Purchasing & Logistics</strong> saat ini sedang dalam tahap pengembangan aktif. 
                  Beberapa fitur mungkin belum sepenuhnya stabil atau masih dalam proses penyempurnaan.
                </p>
                
                <!-- Feature Status Indicators -->
                <div class="flex flex-wrap gap-2 mb-3">
                  <div class="flex items-center gap-1 px-3 py-1 bg-white/15 backdrop-blur-sm rounded-full text-xs border border-white/30">
                    <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                    <span class="text-white/90">Core Features</span>
                  </div>
                  <div class="flex items-center gap-1 px-3 py-1 bg-white/15 backdrop-blur-sm rounded-full text-xs border border-white/30">
                    <div class="w-2 h-2 bg-yellow-400 rounded-full animate-pulse"></div>
                    <span class="text-white/90">Advanced Features</span>
                  </div>
                  <div class="flex items-center gap-1 px-3 py-1 bg-white/15 backdrop-blur-sm rounded-full text-xs border border-white/30">
                    <div class="w-2 h-2 bg-orange-400 rounded-full animate-pulse"></div>
                    <span class="text-white/90">Beta Testing</span>
                  </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex flex-wrap gap-2">
                  <button 
                    onclick="showDevelopmentDetails()" 
                    class="development-btn px-4 py-2 bg-white/20 hover:bg-white/30 backdrop-blur-sm text-white text-sm font-medium rounded-lg border border-white/30 hover:border-white/50 transition-all duration-200 flex items-center gap-2 hover:scale-105 hover:shadow-lg"
                  >
                    <i class="fas fa-info-circle"></i>
                    Detail Info
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Progress Indicator -->
      <div class="absolute bottom-0 left-0 right-0 h-1 bg-white/20">
        <div class="h-full bg-white/50 progress-animate" style="--progress-width: 75%;"></div>
      </div>
    </div>
  </div>
    
  <!-- Statistics Cards Section with Collapse -->
  <div class="mb-8">
    <!-- Header with Toggle (Clickable) -->
    <div 
      onclick="toggleStatsCards()"
      class="flex items-center justify-between mb-4 bg-white cursor-pointer group hover:bg-gray-50 rounded-lg p-3 -m-3 transition-all duration-200"
    >
      <div class="flex items-center space-x-3">
        <div class="w-1 h-8 bg-gradient-to-b from-blue-500 to-purple-600 rounded-full group-hover:h-10 transition-all duration-200"></div>
        <div>
          <h2 class="text-xl font-bold text-gray-800 group-hover:text-gray-900">Statistik Dashboard</h2>
          <p class="text-sm text-gray-500 group-hover:text-gray-600">Overview statistik sistem real-time</p>
        </div>
      </div>
      <div 
        id="statsToggle" 
        class="flex items-center hidden space-x-2 px-4 py-2 bg-white border border-gray-200 rounded-lg group-hover:bg-gray-100 group-hover:border-gray-300 transition-all duration-200 shadow-sm group-hover:shadow-md"
        aria-label="Toggle statistics visibility"
      >
        <span class="text-sm font-medium text-gray-600 group-hover:text-gray-800">Sembunyikan</span>
        <i class="fas fa-chevron-up text-gray-400 group-hover:text-gray-600 transition-all duration-300" id="statsChevron"></i>
      </div>
    </div>

    <!-- Statistics Cards - Modern Design with Gradients -->
    <div id="statsCards" class="stats-expanded transition-all duration-500 ease-in-out overflow-hidden">
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6">

        <!-- Total Jamaah - Teal Gradient -->
        <div class="stat-card group relative overflow-hidden rounded-2xl shadow-lg hover:shadow-2xl">
      <div class="absolute inset-0 bg-gradient-to-br from-teal-500 to-cyan-600 opacity-90 group-hover:opacity-100 transition-opacity"></div>
      <div class="relative p-6 text-white">
        <div class="flex items-start justify-between mb-4">
          <div class="flex-1">
            <p class="text-white/80 text-sm font-semibold uppercase tracking-wider mb-1">Total Jamaah</p>
            <h3 class="text-4xl md:text-5xl font-black"><%= stats.totalJamaah %></h3>
          </div>
          <div class="flex-none bg-white/20 backdrop-blur-sm p-4 rounded-xl group-hover:scale-110 transition-transform">
            <i class="fas fa-users text-3xl text-white"></i>
          </div>
        </div>
        <div class="flex items-center text-white/90 text-sm">
          <i class="fas fa-user-check mr-2"></i>
          <span>Jamaah Terdaftar</span>
        </div>
      </div>
      <div class="absolute -bottom-8 -right-8 w-32 h-32 bg-white/10 rounded-full"></div>
    </div>

    <!-- Total Cabang - Blue Gradient -->
    <div class="stat-card group relative overflow-hidden rounded-2xl shadow-lg hover:shadow-2xl">
      <div class="absolute inset-0 gradient-bg-blue opacity-90 group-hover:opacity-100 transition-opacity"></div>
      <div class="relative p-6 text-white">
        <div class="flex items-start justify-between mb-4">
          <div class="flex-1">
            <p class="text-white/80 text-sm font-semibold uppercase tracking-wider mb-1">Total Cabang</p>
            <h3 class="text-4xl md:text-5xl font-black"><%= stats.branches %></h3>
          </div>
          <div class="flex-none bg-white/20 backdrop-blur-sm p-4 rounded-xl group-hover:scale-110 transition-transform">
            <i class="fas fa-building text-3xl text-white"></i>
          </div>
        </div>
        <div class="flex items-center text-white/90 text-sm">
          <i class="fas fa-map-marker-alt mr-2"></i>
          <span>Lokasi Aktif</span>
        </div>
      </div>
      <!-- Decorative Circle -->
      <div class="absolute -bottom-8 -right-8 w-32 h-32 bg-white/10 rounded-full"></div>
    </div>
    
    <!-- Total Supplier - Pink Gradient -->
    <div class="stat-card group relative overflow-hidden rounded-2xl shadow-lg hover:shadow-2xl">
      <div class="absolute inset-0 gradient-bg-green opacity-90 group-hover:opacity-100 transition-opacity"></div>
      <div class="relative p-6 text-white">
        <div class="flex items-start justify-between mb-4">
          <div class="flex-1">
            <p class="text-white/80 text-sm font-semibold uppercase tracking-wider mb-1">Total Supplier</p>
            <h3 class="text-4xl md:text-5xl font-black"><%= stats.suppliers %></h3>
          </div>
          <div class="flex-none bg-white/20 backdrop-blur-sm p-4 rounded-xl group-hover:scale-110 transition-transform">
            <i class="fas fa-truck text-3xl text-white"></i>
          </div>
        </div>
        <div class="flex items-center text-white/90 text-sm">
          <i class="fas fa-handshake mr-2"></i>
          <span>Mitra Terdaftar</span>
        </div>
      </div>
      <div class="absolute -bottom-8 -right-8 w-32 h-32 bg-white/10 rounded-full"></div>
    </div>
    
    <!-- Total Gudang - Orange Gradient -->
    <div class="stat-card group relative overflow-hidden rounded-2xl shadow-lg hover:shadow-2xl">
      <div class="absolute inset-0 gradient-bg-orange opacity-90 group-hover:opacity-100 transition-opacity"></div>
      <div class="relative p-6 text-white">
        <div class="flex items-start justify-between mb-4">
          <div class="flex-1">
            <p class="text-white/80 text-sm font-semibold uppercase tracking-wider mb-1">Total Gudang</p>
            <h3 class="text-4xl md:text-5xl font-black"><%= stats.warehouses %></h3>
          </div>
          <div class="flex-none bg-white/20 backdrop-blur-sm p-4 rounded-xl group-hover:scale-110 transition-transform">
            <i class="fas fa-warehouse text-3xl text-white"></i>
          </div>
        </div>
        <div class="flex items-center text-white/90 text-sm">
          <i class="fas fa-archive mr-2"></i>
          <span>Fasilitas Storage</span>
        </div>
      </div>
      <div class="absolute -bottom-8 -right-8 w-32 h-32 bg-white/10 rounded-full"></div>
    </div>

      </div>
    </div>
  </div>
 
</main>
  
  <%- include('../partials/footer') %>
  
  <%- include('../partials/scripts') %>

  <script>
    // Statistics Cards Toggle Functionality
    let isStatsVisible = true;

    function toggleStatsCards() {
      const statsCards = document.getElementById('statsCards');
      const statsToggle = document.getElementById('statsToggle');
      const statsChevron = document.getElementById('statsChevron');
      const toggleText = statsToggle.querySelector('span');
      
      if (isStatsVisible) {
        // Hide stats
        statsCards.classList.add('stats-collapsed');
        statsCards.classList.remove('stats-expanded');
        statsChevron.classList.remove('fa-chevron-up');
        statsChevron.classList.add('fa-chevron-down');
        toggleText.textContent = 'Tampilkan';
        
        // Store preference
        localStorage.setItem('dashboard-stats-visible', 'false');
      } else {
        // Show stats
        statsCards.classList.remove('stats-collapsed');
        statsCards.classList.add('stats-expanded');
        statsChevron.classList.remove('fa-chevron-down');
        statsChevron.classList.add('fa-chevron-up');
        toggleText.textContent = 'Sembunyikan';
        
        // Store preference
        localStorage.setItem('dashboard-stats-visible', 'true');
      }
      
      isStatsVisible = !isStatsVisible;
    }

    // Progress Bar Initialization
    document.addEventListener('DOMContentLoaded', function() {
      const progressBars = document.querySelectorAll('.progress-bar');
      progressBars.forEach(bar => {
        const width = bar.getAttribute('data-width');
        bar.style.width = width + '%';
      });
    });

    // Equipment Cards Toggle Functionality
    let isEquipmentVisible = true;

    function toggleEquipmentCards() {
      const equipmentCards = document.getElementById('equipmentCards');
      const equipmentChevron = document.getElementById('equipmentChevron');
      const headerDiv = event.currentTarget;
      const toggleText = headerDiv.querySelector('span');
      
      if (isEquipmentVisible) {
        // Hide equipment
        equipmentCards.classList.add('equipment-collapsed');
        equipmentCards.classList.remove('equipment-expanded');
        equipmentChevron.classList.remove('fa-chevron-up');
        equipmentChevron.classList.add('fa-chevron-down');
        toggleText.textContent = 'Tampilkan';
        
        // Store preference
        localStorage.setItem('dashboard-equipment-visible', 'false');
      } else {
        // Show equipment
        equipmentCards.classList.remove('equipment-collapsed');
        equipmentCards.classList.add('equipment-expanded');
        equipmentChevron.classList.remove('fa-chevron-down');
        equipmentChevron.classList.add('fa-chevron-up');
        toggleText.textContent = 'Sembunyikan';
        
        // Store preference
        localStorage.setItem('dashboard-equipment-visible', 'true');
      }
      
      isEquipmentVisible = !isEquipmentVisible;
    }

    // Toggle Equipment Detail Lists
    function toggleEquipmentDetail(type) {
      event.stopPropagation(); // Prevent parent onclick
      
      const lists = {
        'available': document.getElementById('availableList'),
        'lowStock': document.getElementById('lowStockList'),
        'outOfStock': document.getElementById('outOfStockList')
      };
      
      // Hide all other lists
      Object.keys(lists).forEach(key => {
        if (key !== type) {
          lists[key].classList.add('hidden');
        }
      });
      
      // Toggle selected list
      lists[type].classList.toggle('hidden');
    }

    // Toast Notification Functions
    function showToast(title, message, type = 'success') {
      const toast = document.getElementById('toastNotification');
      const toastIcon = document.getElementById('toastIcon');
      const toastTitle = document.getElementById('toastTitle');
      const toastMessage = document.getElementById('toastMessage');
      const toastProgress = document.getElementById('toastProgress');
      
      // Set content
      toastTitle.textContent = title;
      toastMessage.textContent = message;
      
      // Set icon and color based on type
      const types = {
        success: { icon: 'fas fa-check', bg: 'bg-green-500', progress: 'bg-green-500' },
        info: { icon: 'fas fa-info', bg: 'bg-blue-500', progress: 'bg-blue-500' },
        warning: { icon: 'fas fa-exclamation-triangle', bg: 'bg-yellow-500', progress: 'bg-yellow-500' },
        error: { icon: 'fas fa-times', bg: 'bg-red-500', progress: 'bg-red-500' }
      };
      
      const config = types[type] || types.info;
      toastIcon.className = `flex-none w-8 h-8 rounded-lg flex items-center justify-center ${config.bg}`;
      toastIcon.querySelector('i').className = `${config.icon} text-white text-sm`;
      toastProgress.className = `h-full transition-all duration-[3000ms] ease-linear ${config.progress}`;
      
      // Show toast
        // Ensure any existing toast timers or animations are cleared so toasts don't stack
        if (window._toastHideTimer) { clearTimeout(window._toastHideTimer); window._toastHideTimer = null; }
        if (window._toastResetTimer) { clearTimeout(window._toastResetTimer); window._toastResetTimer = null; }

        // Show toast (slide in)
        toast.classList.remove('translate-x-full');
        toast.classList.add('translate-x-0');

        // Reset and start progress animation reliably
        // force progress width to 100% first, then transition to 0 so CSS transition runs
        toastProgress.style.transition = 'none';
        toastProgress.style.width = '100%';
        // next tick: allow transition and animate to 0
        window._toastResetTimer = setTimeout(() => {
          toastProgress.style.transition = 'width 3000ms linear';
          // small timeout to ensure transition property applied
          requestAnimationFrame(() => { toastProgress.style.width = '0%'; });
        }, 20);

        // Auto hide after same duration as progress (3s)
        window._toastHideTimer = setTimeout(() => {
          hideToast();
          window._toastHideTimer = null;
        }, 3000);
    }

    function hideToast() {
      const toast = document.getElementById('toastNotification');
      const toastProgress = document.getElementById('toastProgress');
      
      toast.classList.remove('translate-x-0');
      toast.classList.add('translate-x-full');
      
      // Reset progress bar
      setTimeout(() => {
        toastProgress.style.width = '100%';
      }, 300);
    }

    // Development Alert Functions
    function showDevelopmentDetails() {
      const modal = document.getElementById('developmentModal');
      modal.classList.remove('hidden');
      document.body.style.overflow = 'hidden'; // Prevent background scrolling
      
      // Show info toast
      showToast('Detail Pengembangan', 'Modal informasi detail telah dibuka', 'info');
    }

    function closeDevelopmentModal() {
      const modal = document.getElementById('developmentModal');
      modal.classList.add('hidden');
      document.body.style.overflow = 'auto'; // Restore scrolling
    }

    // dismissAlert function removed - alert now always visible for development status visibility

    function reportBug() {
      // Show information toast
      showToast('Fitur Bug Report', 'Fitur pelaporan bug akan segera tersedia!', 'info');
      
      // Optionally redirect to a contact form or email
      // window.open('mailto:developer@rahmahtravel.com?subject=Bug Report - Purchasing System', '_blank');
    }

    function contactEmail() {
      showToast('Email Developer', 'Membuka aplikasi email...', 'info');
      // Replace with actual developer email
      window.open('dimasagustav@gmail.com?subject=Purchasing System - Development Inquiry&body=Halo Developer,%0D%0A%0D%0ASaya ingin menanyakan tentang sistem Purchasing & Logistics...', '_blank');
    }

    function contactWhatsApp() {
      showToast('WhatsApp Developer', 'Membuka WhatsApp...', 'success');
      // Replace with actual WhatsApp number (format: 62xxxxx without +)
      const phoneNumber = '6281935679330'; // Replace with actual number
      const message = encodeURIComponent('Halo Developer, saya ingin menanyakan tentang sistem Purchasing & Logistics Rahmah Travel');
      window.open(`https://wa.me/${phoneNumber}?text=${message}`, '_blank');
    }

    // Close modal when clicking outside
    document.getElementById('developmentModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeDevelopmentModal();
      }
    });

    // Restore preferences on page load
    document.addEventListener('DOMContentLoaded', function() {
      // Development alert is now always visible - no 24-hour hide functionality
      // Welcome toast removed per user request

      const savedStatsVisibility = localStorage.getItem('dashboard-stats-visible');
      if (savedStatsVisibility === 'false') {
        setTimeout(() => {
          toggleStatsCards();
        }, 100);
      }

      const savedEquipmentVisibility = localStorage.getItem('dashboard-equipment-visible');
      if (savedEquipmentVisibility === 'false') {
        setTimeout(() => {
          const headerElement = document.querySelector('[onclick="toggleEquipmentCards()"]');
          if (headerElement) {
            headerElement.click();
          }
        }, 100);
      }
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', function(e) {
      // ESC key to close modal
      if (e.key === 'Escape') {
        closeDevelopmentModal();
      }
    });
  </script>
</body>
</html>